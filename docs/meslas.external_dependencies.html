

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>meslas.external_dependencies package &mdash; MESLAS 0.1 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link href="_static/style.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> MESLAS
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="philosophy.html">Notations and Conventions for the MESLAS package</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Main Modules:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="grid.html">Gridding Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="random_fields.html">Gaussian Random Field Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="sensor.html">Sensor Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="means.html">Means module</a></li>
<li class="toctree-l1"><a class="reference internal" href="plotting.html">Plotting module</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MESLAS</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>meslas.external_dependencies package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/meslas.external_dependencies.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="meslas-external-dependencies-package">
<h1>meslas.external_dependencies package<a class="headerlink" href="#meslas-external-dependencies-package" title="Permalink to this heading">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading">¶</a></h2>
</section>
<section id="module-meslas.external_dependencies.numpytorch">
<span id="meslas-external-dependencies-numpytorch-module"></span><h2>meslas.external_dependencies.numpytorch module<a class="headerlink" href="#module-meslas.external_dependencies.numpytorch" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.WrapTorch">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">WrapTorch</span></span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.WrapTorch" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Uses torch as the backend; allows numpy-style sytax</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>newaxis</strong></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#meslas.external_dependencies.numpytorch.WrapTorch.arange" title="meslas.external_dependencies.numpytorch.WrapTorch.arange"><code class="xref py py-obj docutils literal notranslate"><span class="pre">arange</span></code></a>([start, step, out, dtype, layout, ...])</p></td>
<td><p>Returns a 1-D tensor of size <span class="math notranslate nohighlight">\(\left\lceil \frac{\text{end} - \text{start}}{\text{step}} \right\rceil\)</span> with values from the interval <code class="docutils literal notranslate"><span class="pre">[start,</span> <span class="pre">end)</span></code> taken with common difference <code class="xref py py-attr docutils literal notranslate"><span class="pre">step</span></code> beginning from <cite>start</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#meslas.external_dependencies.numpytorch.WrapTorch.array" title="meslas.external_dependencies.numpytorch.WrapTorch.array"><code class="xref py py-obj docutils literal notranslate"><span class="pre">array</span></code></a></p></td>
<td><p>tensor(data, <a href="#id1"><span class="problematic" id="id2">*</span></a>, dtype=None, device=None, requires_grad=False, pin_memory=False) -&gt; Tensor</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#meslas.external_dependencies.numpytorch.WrapTorch.cat" title="meslas.external_dependencies.numpytorch.WrapTorch.cat"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cat</span></code></a>(tensors[, dim, out])</p></td>
<td><p>Concatenates the given sequence of <code class="xref py py-attr docutils literal notranslate"><span class="pre">seq</span></code> tensors in the given dimension.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#meslas.external_dependencies.numpytorch.WrapTorch.exp" title="meslas.external_dependencies.numpytorch.WrapTorch.exp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">exp</span></code></a>(input, *[, out])</p></td>
<td><p>Returns a new tensor with the exponential of the elements of the input tensor <code class="xref py py-attr docutils literal notranslate"><span class="pre">input</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#meslas.external_dependencies.numpytorch.WrapTorch.log" title="meslas.external_dependencies.numpytorch.WrapTorch.log"><code class="xref py py-obj docutils literal notranslate"><span class="pre">log</span></code></a>(input, *[, out])</p></td>
<td><p>Returns a new tensor with the natural logarithm of the elements of <code class="xref py py-attr docutils literal notranslate"><span class="pre">input</span></code>.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><strong>abs</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>argmax</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>argmin</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>max</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>min</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>ones</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>sum</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>sumto1</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>zeros</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.WrapTorch.abs">
<span class="sig-name descname"><span class="pre">abs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.WrapTorch.abs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.WrapTorch.arange">
<span class="sig-name descname"><span class="pre">arange</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start=0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layout=torch.strided</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">requires_grad=False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.WrapTorch.arange" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a 1-D tensor of size <span class="math notranslate nohighlight">\(\left\lceil \frac{\text{end} - \text{start}}{\text{step}} \right\rceil\)</span>
with values from the interval <code class="docutils literal notranslate"><span class="pre">[start,</span> <span class="pre">end)</span></code> taken with common difference
<code class="xref py py-attr docutils literal notranslate"><span class="pre">step</span></code> beginning from <cite>start</cite>.</p>
<p>Note that non-integer <code class="xref py py-attr docutils literal notranslate"><span class="pre">step</span></code> is subject to floating point rounding errors when
comparing against <code class="xref py py-attr docutils literal notranslate"><span class="pre">end</span></code>; to avoid inconsistency, we advise adding a small epsilon to <code class="xref py py-attr docutils literal notranslate"><span class="pre">end</span></code>
in such cases.</p>
<div class="math notranslate nohighlight">
\[\text{out}_{{i+1}} = \text{out}_{i} + \text{step}\]</div>
<dl>
<dt>Args:</dt><dd><p>start (Number): the starting value for the set of points. Default: <code class="docutils literal notranslate"><span class="pre">0</span></code>.
end (Number): the ending value for the set of points
step (Number): the gap between each pair of adjacent points. Default: <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p>
</dd>
<dt>Keyword args:</dt><dd><p>out (Tensor, optional): the output tensor.
dtype (<code class="xref py py-class docutils literal notranslate"><span class="pre">torch.dtype</span></code>, optional): the desired data type of returned tensor.</p>
<blockquote>
<div><p>Default: if <code class="docutils literal notranslate"><span class="pre">None</span></code>, uses a global default (see <code class="xref py py-func docutils literal notranslate"><span class="pre">torch.set_default_tensor_type()</span></code>). If <cite>dtype</cite> is not given, infer the data type from the other input
arguments. If any of <cite>start</cite>, <cite>end</cite>, or <cite>stop</cite> are floating-point, the
<cite>dtype</cite> is inferred to be the default dtype, see
<code class="xref py py-meth docutils literal notranslate"><span class="pre">get_default_dtype()</span></code>. Otherwise, the <cite>dtype</cite> is inferred to
be <cite>torch.int64</cite>.</p>
</div></blockquote>
<dl class="simple">
<dt>layout (<code class="xref py py-class docutils literal notranslate"><span class="pre">torch.layout</span></code>, optional): the desired layout of returned Tensor.</dt><dd><p>Default: <code class="docutils literal notranslate"><span class="pre">torch.strided</span></code>.</p>
</dd>
<dt>device (<code class="xref py py-class docutils literal notranslate"><span class="pre">torch.device</span></code>, optional): the desired device of returned tensor.</dt><dd><p>Default: if <code class="docutils literal notranslate"><span class="pre">None</span></code>, uses the current device for the default tensor type
(see <code class="xref py py-func docutils literal notranslate"><span class="pre">torch.set_default_tensor_type()</span></code>). <code class="xref py py-attr docutils literal notranslate"><span class="pre">device</span></code> will be the CPU
for CPU tensor types and the current CUDA device for CUDA tensor types.</p>
</dd>
<dt>requires_grad (bool, optional): If autograd should record operations on the</dt><dd><p>returned tensor. Default: <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">tensor([ 0,  1,  2,  3,  4])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">tensor([ 1,  2,  3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="go">tensor([ 1.0000,  1.5000,  2.0000])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.WrapTorch.argmax">
<span class="sig-name descname"><span class="pre">argmax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.WrapTorch.argmax" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.WrapTorch.argmin">
<span class="sig-name descname"><span class="pre">argmin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.WrapTorch.argmin" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.WrapTorch.array">
<span class="sig-name descname"><span class="pre">array</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.WrapTorch.array" title="Permalink to this definition">¶</a></dt>
<dd><p>tensor(data, <a href="#id3"><span class="problematic" id="id4">*</span></a>, dtype=None, device=None, requires_grad=False, pin_memory=False) -&gt; Tensor</p>
<p>Constructs a tensor with no autograd history (also known as a “leaf tensor”, see <span class="xref std std-doc">/notes/autograd</span>) by copying <code class="xref py py-attr docutils literal notranslate"><span class="pre">data</span></code>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When working with tensors prefer using <code class="xref py py-func docutils literal notranslate"><span class="pre">torch.Tensor.clone()</span></code>,
<code class="xref py py-func docutils literal notranslate"><span class="pre">torch.Tensor.detach()</span></code>, and <code class="xref py py-func docutils literal notranslate"><span class="pre">torch.Tensor.requires_grad_()</span></code> for
readability. Letting <cite>t</cite> be a tensor, <code class="docutils literal notranslate"><span class="pre">torch.tensor(t)</span></code> is equivalent to
<code class="docutils literal notranslate"><span class="pre">t.clone().detach()</span></code>, and <code class="docutils literal notranslate"><span class="pre">torch.tensor(t,</span> <span class="pre">requires_grad=True)</span></code>
is equivalent to <code class="docutils literal notranslate"><span class="pre">t.clone().detach().requires_grad_(True)</span></code>.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-func docutils literal notranslate"><span class="pre">torch.as_tensor()</span></code> preserves autograd history and avoids copies where possible.
<code class="xref py py-func docutils literal notranslate"><span class="pre">torch.from_numpy()</span></code> creates a tensor that shares storage with a NumPy array.</p>
</div>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>data (array_like): Initial data for the tensor. Can be a list, tuple,</dt><dd><p>NumPy <code class="docutils literal notranslate"><span class="pre">ndarray</span></code>, scalar, and other types.</p>
</dd>
</dl>
</dd>
<dt>Keyword args:</dt><dd><dl class="simple">
<dt>dtype (<code class="xref py py-class docutils literal notranslate"><span class="pre">torch.dtype</span></code>, optional): the desired data type of returned tensor.</dt><dd><p>Default: if <code class="docutils literal notranslate"><span class="pre">None</span></code>, infers data type from <code class="xref py py-attr docutils literal notranslate"><span class="pre">data</span></code>.</p>
</dd>
<dt>device (<code class="xref py py-class docutils literal notranslate"><span class="pre">torch.device</span></code>, optional): the device of the constructed tensor. If None and data is a tensor</dt><dd><p>then the device of data is used. If None and data is not a tensor then
the result tensor is constructed on the CPU.</p>
</dd>
<dt>requires_grad (bool, optional): If autograd should record operations on the</dt><dd><p>returned tensor. Default: <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</dd>
<dt>pin_memory (bool, optional): If set, returned tensor would be allocated in</dt><dd><p>the pinned memory. Works only for CPU tensors. Default: <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">],</span> <span class="p">[</span><span class="mf">2.2</span><span class="p">,</span> <span class="mf">3.1</span><span class="p">],</span> <span class="p">[</span><span class="mf">4.9</span><span class="p">,</span> <span class="mf">5.2</span><span class="p">]])</span>
<span class="go">tensor([[ 0.1000,  1.2000],</span>
<span class="go">        [ 2.2000,  3.1000],</span>
<span class="go">        [ 4.9000,  5.2000]])</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>  <span class="c1"># Type inference on data</span>
<span class="go">tensor([ 0,  1])</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">0.11111</span><span class="p">,</span> <span class="mf">0.222222</span><span class="p">,</span> <span class="mf">0.3333333</span><span class="p">]],</span>
<span class="gp">... </span>             <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span>
<span class="gp">... </span>             <span class="n">device</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">))</span>  <span class="c1"># creates a double tensor on a CUDA device</span>
<span class="go">tensor([[ 0.1111,  0.2222,  0.3333]], dtype=torch.float64, device=&#39;cuda:0&#39;)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="mf">3.14159</span><span class="p">)</span>  <span class="c1"># Create a zero-dimensional (scalar) tensor</span>
<span class="go">tensor(3.1416)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([])</span>  <span class="c1"># Create an empty tensor (of size (0,))</span>
<span class="go">tensor([])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.WrapTorch.backend">
<span class="sig-name descname"><span class="pre">backend</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;module</span> <span class="pre">'torch'</span> <span class="pre">from</span> <span class="pre">'/home/cedric/miniconda3/envs/submarine/lib/python3.8/site-packages/torch/__init__.py'&gt;</span></em><a class="headerlink" href="#meslas.external_dependencies.numpytorch.WrapTorch.backend" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.WrapTorch.cat">
<span class="sig-name descname"><span class="pre">cat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.WrapTorch.cat" title="Permalink to this definition">¶</a></dt>
<dd><p>Concatenates the given sequence of <code class="xref py py-attr docutils literal notranslate"><span class="pre">seq</span></code> tensors in the given dimension.
All tensors must either have the same shape (except in the concatenating
dimension) or be empty.</p>
<p><code class="xref py py-func docutils literal notranslate"><span class="pre">torch.cat()</span></code> can be seen as an inverse operation for <code class="xref py py-func docutils literal notranslate"><span class="pre">torch.split()</span></code>
and <code class="xref py py-func docutils literal notranslate"><span class="pre">torch.chunk()</span></code>.</p>
<p><code class="xref py py-func docutils literal notranslate"><span class="pre">torch.cat()</span></code> can be best understood via examples.</p>
<dl>
<dt>Args:</dt><dd><dl class="simple">
<dt>tensors (sequence of Tensors): any python sequence of tensors of the same type.</dt><dd><p>Non-empty tensors provided must have the same shape, except in the
cat dimension.</p>
</dd>
</dl>
<p>dim (int, optional): the dimension over which the tensors are concatenated</p>
</dd>
<dt>Keyword args:</dt><dd><p>out (Tensor, optional): the output tensor.</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span>
<span class="go">tensor([[ 0.6580, -1.0969, -0.4614],</span>
<span class="go">        [-0.1034, -0.5790,  0.1497]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">tensor([[ 0.6580, -1.0969, -0.4614],</span>
<span class="go">        [-0.1034, -0.5790,  0.1497],</span>
<span class="go">        [ 0.6580, -1.0969, -0.4614],</span>
<span class="go">        [-0.1034, -0.5790,  0.1497],</span>
<span class="go">        [ 0.6580, -1.0969, -0.4614],</span>
<span class="go">        [-0.1034, -0.5790,  0.1497]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">tensor([[ 0.6580, -1.0969, -0.4614,  0.6580, -1.0969, -0.4614,  0.6580,</span>
<span class="go">         -1.0969, -0.4614],</span>
<span class="go">        [-0.1034, -0.5790,  0.1497, -0.1034, -0.5790,  0.1497, -0.1034,</span>
<span class="go">         -0.5790,  0.1497]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.WrapTorch.exp">
<span class="sig-name descname"><span class="pre">exp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.WrapTorch.exp" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a new tensor with the exponential of the elements
of the input tensor <code class="xref py py-attr docutils literal notranslate"><span class="pre">input</span></code>.</p>
<div class="math notranslate nohighlight">
\[y_{i} = e^{x_{i}}\]</div>
<dl class="simple">
<dt>Args:</dt><dd><p>input (Tensor): the input tensor.</p>
</dd>
<dt>Keyword args:</dt><dd><p>out (Tensor, optional): the output tensor.</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">2.</span><span class="p">)]))</span>
<span class="go">tensor([ 1.,  2.])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.WrapTorch.log">
<span class="sig-name descname"><span class="pre">log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.WrapTorch.log" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a new tensor with the natural logarithm of the elements
of <code class="xref py py-attr docutils literal notranslate"><span class="pre">input</span></code>.</p>
<div class="math notranslate nohighlight">
\[y_{i} = \log_{e} (x_{i})\]</div>
<dl class="simple">
<dt>Args:</dt><dd><p>input (Tensor): the input tensor.</p>
</dd>
<dt>Keyword args:</dt><dd><p>out (Tensor, optional): the output tensor.</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">tensor([4.7767, 4.3234, 1.2156, 0.2411, 4.5739])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">torch</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">tensor([ 1.5637,  1.4640,  0.1952, -1.4226,  1.5204])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.WrapTorch.max">
<span class="sig-name descname"><span class="pre">max</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.WrapTorch.max" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.WrapTorch.min">
<span class="sig-name descname"><span class="pre">min</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.WrapTorch.min" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.WrapTorch.newaxis">
<span class="sig-name descname"><span class="pre">newaxis</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#meslas.external_dependencies.numpytorch.WrapTorch.newaxis" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.WrapTorch.ones">
<span class="sig-name descname"><span class="pre">ones</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.WrapTorch.ones" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.WrapTorch.sum">
<span class="sig-name descname"><span class="pre">sum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.WrapTorch.sum" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.WrapTorch.sumto1">
<span class="sig-name descname"><span class="pre">sumto1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.WrapTorch.sumto1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.WrapTorch.zeros">
<span class="sig-name descname"><span class="pre">zeros</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.WrapTorch.zeros" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.aggregate">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">aggregate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.aggregate" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>subs</strong> (torch.LongTensor, (<a href="#id5"><span class="problematic" id="id6">*</span></a>torch.LongTensor)) – [dim, element]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.append_dim">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">append_dim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_dim_to_append</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.append_dim" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.append_to_ndim">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">append_to_ndim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_dim_desired</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.append_to_ndim" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.attach_dim">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">attach_dim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_dim_to_prepend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_dim_to_append</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.attach_dim" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.block_diag">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">block_diag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.block_diag" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a block diagonal matrix along dim=-3
EXAMPLE:
block_diag(torch.ones(4,3,2))
should give a 12 x 8 matrix with blocks of 3 x 2 ones.
Prepend batch dimensions if needed.
You can also give a list of matrices.
:type m: torch.Tensor, list
:rtype: torch.Tensor</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.block_diag_irregular">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">block_diag_irregular</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matrices</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.block_diag_irregular" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.bootstrap">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">bootstrap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fun</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_boot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.bootstrap" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.categrnd">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">categrnd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">probs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.categrnd" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.circdiff">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">circdiff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">angle1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxangle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tensor(6.2832)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.circdiff" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>angle1</strong> – angle scaled to be between 0 and maxangle</p></li>
<li><p><strong>angle2</strong> – angle scaled to be between 0 and maxangle</p></li>
<li><p><strong>maxangle</strong> – max angle. defaults to 2 * pi.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>angular difference, between -.5 and +.5 * maxangle</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.conv_t">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">conv_t</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.conv_t" title="Permalink to this definition">¶</a></dt>
<dd><p>1D convolution with the starting time of the signal and kernel anchored.</p>
<p>EXAMPLE:
p_cond_rt = npt.conv_t(</p>
<blockquote>
<div><p>p_cond_td[None],  # [1, cond, fr]
p_tnd[None, None, :].expand([n_cond, 1, nt]), # [cond, 1, fr]
groups=n_cond</p>
</div></blockquote>
<p>)
:param p: [batch, time] or [batch, channel_in, time]
:param kernel: [time] or [channel_out, channel_in, time]
:param kwargs: fed to F.conv1d
:return: p[batch, time] or [batch, channel_out, time]</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.crossvalincl">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">crossvalincl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_tr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i_fold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_fold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'consec'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.crossvalincl" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_tr</strong> – Number of trials</p></li>
<li><p><strong>i_fold</strong> – Index of fold</p></li>
<li><p><strong>n_fold</strong> – Number of folds. If 1, training set = test set.</p></li>
<li><p><strong>mode</strong> – ‘consec’: consecutive trials; ‘mod’: interleaved</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>boolean (Byte) tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.deg2rad">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">deg2rad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.deg2rad" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.delta">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">delta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">levels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dlevel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.delta" title="Permalink to this definition">¶</a></dt>
<dd><p>&#64;type levels: torch.Tensor
&#64;type v: torch.Tensor
&#64;type dlevel: torch.Tensor
&#64;rtype: torch.Tensor</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.enforce_tensor">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">enforce_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_ndim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.enforce_tensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a tensor if the input is not; otherwise return the input as is.
Same as enforce_tensor
:param v:
:param min_ndim:
:param kwargs:
:return:</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.entropy">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">entropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.entropy" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tensor</strong> (<em>torch.Tensor</em>) – probability. Optionally provide dim and keepdim for</p>
</dd>
</dl>
<p>summation.
:return: torch.Tensor</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.expand_all">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">expand_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.expand_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Expand tensors so that all tensors are of the same size.
Tensors must have the same number of dimensions;
otherwise, use expand_batch() to prepend dimensions.
:param args:
:param shape:
:return:</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.expand_batch">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">expand_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.expand_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Same as repeat_batch except forcing use_expand=True, to share memory
across repeats, i.e., expand first dimensions, while keeping last
dimensions the same
:param args: tuple of tensors to repeat.
:param repeat_existing_dims: whether to repeat singleton dims.
:param to_append_dims: if True, append dims if needed; if False, prepend.
:param shape: desired shape of the output. Give None to match max shape
of each dim. Give -1 at dims where the max shape is desired.
:return: tuple of repeated tensors.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.expand_upto_dim">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">expand_upto_dim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_expand_left</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.expand_upto_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Similar to expand_batch(), but keeps some dims unexpanded even if they
don’t match.
:param args: iterable yielding torch.Tensor
:param dim: if to_expand_left=True, then arg[:dim] is expanded,</p>
<blockquote>
<div><p>otherwise, arg[dim:] is expanded, for each arg in args.
Note that dim=-1 leaves the last dim unexpanded.
This is necessary to make dim=0 expand the first.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>to_expand_left</strong> – if True, left of dim is expanded while the rest of</p>
</dd>
</dl>
<p>the dims are kept unchanged.
:return: tuple of expanded args</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.float">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">float</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.float" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.freeze">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">freeze</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">module</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.freeze" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.get_jacobian">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">get_jacobian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">net</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noutputs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.get_jacobian" title="Permalink to this definition">¶</a></dt>
<dd><p>From <a class="reference external" href="https://gist.github.com/sbarratt/37356c46ad1350d4c30aefbd488a4faa">https://gist.github.com/sbarratt/37356c46ad1350d4c30aefbd488a4faa</a>
:type net: torch.nn.Module
:type x: torch.Tensor
:type noutputs: int
:rtype: torch.Tensor</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.interp1d">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">interp1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.interp1d" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query</strong> – index on dim. Should be a FloatTensor for gradient.</p></li>
<li><p><strong>value</strong> – </p></li>
<li><p><strong>dim</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>interpolated to give value[query] (when dim=0)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.inv_gaussian_cdf">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">inv_gaussian_cdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.inv_gaussian_cdf" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.inv_gaussian_mean_std2params">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">inv_gaussian_mean_std2params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.inv_gaussian_mean_std2params" title="Permalink to this definition">¶</a></dt>
<dd><p>mu, std -&gt; mu, lam</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.inv_gaussian_pdf">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">inv_gaussian_pdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.inv_gaussian_pdf" title="Permalink to this definition">¶</a></dt>
<dd><p>As in <a class="reference external" href="https://en.wikipedia.org/wiki/Inverse_Gaussian_distribution">https://en.wikipedia.org/wiki/Inverse_Gaussian_distribution</a>
&#64;param x: values to query. Must be positive.
&#64;param mu: the expectation
&#64;param lam: lambda in Wikipedia’s notation
&#64;return: p(x; mu, lam)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.inv_gaussian_pmf_mean_stdev">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">inv_gaussian_pmf_mean_stdev</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'diff_cdf'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.inv_gaussian_pmf_mean_stdev" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – must be a 1-dim tensor along dim.</p></li>
<li><p><strong>mu</strong> – </p></li>
<li><p><strong>std</strong> – </p></li>
<li><p><strong>dx</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.inv_gaussian_variance">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">inv_gaussian_variance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.inv_gaussian_variance" title="Permalink to this definition">¶</a></dt>
<dd><p>As in <a class="reference external" href="https://en.wikipedia.org/wiki/Inverse_Gaussian_distribution">https://en.wikipedia.org/wiki/Inverse_Gaussian_distribution</a>
&#64;param mu: the expectation
&#64;param lam: lambda in Wikipedia’s notation
&#64;return: Var[X]</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.inv_gaussian_variance2lam">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">inv_gaussian_variance2lam</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.inv_gaussian_variance2lam" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.isnan">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">isnan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.isnan" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.kron">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">kron</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.kron" title="Permalink to this definition">¶</a></dt>
<dd><p>Kronecker product of matrices a and b with leading batch dimensions.
Batch dimensions are broadcast. The number of them mush
:type a: torch.Tensor
:type b: torch.Tensor
:rtype: torch.Tensor</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.kw_np2torch">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">kw_np2torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kw</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.kw_np2torch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.log_normpdf">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">log_normpdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.log_normpdf" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.logistic">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">logistic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.logistic" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.logit">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">logit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.logit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.lognorm_params_given_mean_stdev">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">lognorm_params_given_mean_stdev</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mean:</span> <span class="pre">~torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stdev:</span> <span class="pre">~torch.Tensor)</span> <span class="pre">-&gt;</span> <span class="pre">(&lt;class</span> <span class="pre">'torch.Tensor'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'torch.Tensor'&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.lognorm_params_given_mean_stdev" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.lognorm_pmf">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">lognorm_pmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stdev</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.lognorm_pmf" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – must be monotonic increasing with equal increment on dim 0</p></li>
<li><p><strong>mean</strong> – </p></li>
<li><p><strong>stdev</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>p[k] = P(x[k] &lt; X &lt; x[k + 1]; mean, stdev)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.lognormal_params2mean_stdev">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">lognormal_params2mean_stdev</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.lognormal_params2mean_stdev" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.m2v">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">m2v</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mm</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.m2v" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.m2v0">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">m2v0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mat</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.m2v0" title="Permalink to this definition">¶</a></dt>
<dd><p>Matrix dims come first, unlike v2m</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.mat2vec0">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">mat2vec0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mat</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.mat2vec0" title="Permalink to this definition">¶</a></dt>
<dd><p>Matrix dims come first, unlike v2m</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.matmul0">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">matmul0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.matmul0" title="Permalink to this definition">¶</a></dt>
<dd><p>Matrix dims come first, unlike torch.matmul</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.matmul2vec">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">matmul2vec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mm</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.matmul2vec" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.matsum">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">matsum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">tensors</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.matsum" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply expand_upto_dim(tensors, -2) before adding them together,
consistent with torch.matmul()
:param tensors: iterable of tensors
:return: sum of tensors, expanded except for the last two dimensions.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.matvecmul0">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">matvecmul0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.matvecmul0" title="Permalink to this definition">¶</a></dt>
<dd><p>Matrix and vec dims come first. Vec is expanded to mat first.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.max_distrib">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">max_distrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p:</span> <span class="pre">~torch.Tensor)</span> <span class="pre">-&gt;</span> <span class="pre">(&lt;class</span> <span class="pre">'torch.Tensor'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'torch.Tensor'&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.max_distrib" title="Permalink to this definition">¶</a></dt>
<dd><p>Distribution of the max of independent RVs R0 ~ p[0] and R1 ~ p[1].
When ndims(p) &gt; 2, each pair of p[0, r0, :] and p[1, r1, :] is processed
separately. p.sum(1) is taken as the number of trials.</p>
<p>p_max, p_1st = min_distrib(p)</p>
<p>p_max(t,1,:): Probability distribution of min(t_1 ~ p(:,1), t_2 ~ p(:,2))
p_last(t,k,:): Probability of t_k happening first at t.</p>
<blockquote>
<div><p>sums(p_1st, [1, 2]) gives all 1’s.</p>
</div></blockquote>
<p>Formula from: <a class="reference external" href="http://math.stackexchange.com/questions/308230/expectation-of-the-min-of-two-independent-random-variables">http://math.stackexchange.com/questions/308230/expectation-of-the-min-of-two-independent-random-variables</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>p</strong> – [id, value, [batch, …]]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>p_max[value, batch, …], p_last[id, value, batch, …]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.max_shape">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">max_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shapes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.max_shape" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.mean_distrib">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">mean_distrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.mean_distrib" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.min_distrib">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">min_distrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p:</span> <span class="pre">~torch.Tensor)</span> <span class="pre">-&gt;</span> <span class="pre">(&lt;class</span> <span class="pre">'torch.Tensor'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'torch.Tensor'&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.min_distrib" title="Permalink to this definition">¶</a></dt>
<dd><p>Distribution of the min of independent RVs R0 ~ p[0] and R1 ~ p[1].
When ndims(p) &gt; 2, each pair of p[0, r0, :] and p[1, r1, :] is processed
separately. p.sum(1) is taken as the number of trials.</p>
<p>p_min, p_1st = min_distrib(p)</p>
<p>p_min(t,1,:): Probability distribution of min(t_1 ~ p(:,1), t_2 ~ p(:,2))
p_1st(t,k,:): Probability of t_k happening first at t.</p>
<blockquote>
<div><p>sums(p_1st, [1, 2]) gives all 1’s.</p>
</div></blockquote>
<p>Formula from: <a class="reference external" href="http://math.stackexchange.com/questions/308230/expectation-of-the-min-of-two-independent-random-variables">http://math.stackexchange.com/questions/308230/expectation-of-the-min-of-two-independent-random-variables</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>p</strong> – [id, value, [batch, …]]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>p_min[value, batch, …], p_1st[id, value, batch, …]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.mm0">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">mm0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.mm0" title="Permalink to this definition">¶</a></dt>
<dd><p>Matrix dims come first, unlike torch.matmul</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.mvm0">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">mvm0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.mvm0" title="Permalink to this definition">¶</a></dt>
<dd><p>Matrix and vec dims come first. Vec is expanded to mat first.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.mvnpdf_log">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">mvnpdf_log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.mvnpdf_log" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – [batch, ndim]</p></li>
<li><p><strong>mu</strong> – [batch, ndim]</p></li>
<li><p><strong>sigma</strong> – [batch, ndim, ndim]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>log_prob [batch]</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.FloatTensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.mvnrnd">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">mvnrnd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.mvnrnd" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.nan2v">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">nan2v</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.nan2v" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.nanmean">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">nanmean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.nanmean" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.nansum">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">nansum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.nansum" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.normrnd">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">normrnd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_distrib</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.normrnd" title="Permalink to this definition">¶</a></dt>
<dd><p>&#64;param mu:
&#64;param sigma:
&#64;param sample_shape:
&#64;type return_distrib: bool
&#64;rtype: Union[(torch.Tensor, torch.distributions.Distribution),
torch.Tensor]</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.npy">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">npy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.npy" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a np.ndarray from tensor; otherwise return the input as is
:type v: torch.Tensor
:rtype: np.ndarray</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.npys">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">npys</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.npys" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.numpy">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">numpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.numpy" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a np.ndarray from tensor; otherwise return the input as is
:type v: torch.Tensor
:rtype: np.ndarray</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.onehotrnd">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">onehotrnd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">probs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.onehotrnd" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.p2en">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">p2en</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndim_st</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.p2en" title="Permalink to this definition">¶</a></dt>
<dd><p>Permute first ndim_en of an array v to the last
:type v: torch.Tensor
:type ndim_st: int
:rtype: torch.Tensor</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.p2st">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">p2st</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndim_en</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.p2st" title="Permalink to this definition">¶</a></dt>
<dd><p>Permute last ndim_en of an array v to the first
:type v: torch.Tensor
:type ndim_en: int
:rtype: torch.Tensor</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.pconc2conc">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">pconc2conc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pconc</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.pconc2conc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.permute2en">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">permute2en</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndim_st</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.permute2en" title="Permalink to this definition">¶</a></dt>
<dd><p>Permute first ndim_en of an array v to the last
:type v: torch.Tensor
:type ndim_st: int
:rtype: torch.Tensor</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.permute2st">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">permute2st</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndim_en</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.permute2st" title="Permalink to this definition">¶</a></dt>
<dd><p>Permute last ndim_en of an array v to the first
:type v: torch.Tensor
:type ndim_en: int
:rtype: torch.Tensor</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.prad2unitvec">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">prad2unitvec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.prad2unitvec" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.prepend_dim">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">prepend_dim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_dim_to_prepend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.prepend_dim" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.prepend_to_ndim">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">prepend_to_ndim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_dim_desired</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.prepend_to_ndim" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.rad2deg">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">rad2deg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rad</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.rad2deg" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.rand">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">rand</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.rand" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.ravel_multi_index">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">ravel_multi_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.ravel_multi_index" title="Permalink to this definition">¶</a></dt>
<dd><p>For now, just use np.ravel_multi_index()
:type v: torch.LongTensor
:type shape: torch.Size, tuple, list
:type kwargs: dict
:return: torch.LongTensor</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.repeat_all">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">repeat_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_expand</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.repeat_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Repeat tensors so that all tensors are of the same size.
Tensors must have the same number of dimensions;
otherwise, use repeat_batch() to prepend dimensions.
:param shape: desired shape of the output. Give None to match max shape
of each dim. Give -1 at dims where the max shape is desired.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.repeat_batch">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">repeat_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repeat_existing_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_append_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_expand</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.repeat_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Repeat first dimensions, while keeping last dimensions the same.
:param args: tuple of tensors to repeat.
:param repeat_existing_dims: whether to repeat singleton dims.
:param to_append_dims: if True, append dims if needed; if False, prepend.
:param shape: desired shape of the output. Give None to match max shape
of each dim. Give -1 at dims where the max shape is desired.
:param use_expand: True to use torch.expand instead of torch.repeat,
to share the same memory across repeats.
:return: tuple of repeated tensors.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.repeat_dim">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">repeat_dim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repeat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.repeat_dim" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.repeat_to_shape">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">repeat_to_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.repeat_to_shape" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>shape</strong> – desired shape of the output</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.scatter_add">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">scatter_add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.scatter_add" title="Permalink to this definition">¶</a></dt>
<dd><p>&#64;param subs: ndim x n indices, suitable for np.ravel_multi_index
&#64;type subs: Union[np.ndarray, torch.LongTensor])
&#64;param val: n x … values to add
&#64;type val: torch.Tensor
&#64;return:</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.sem">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">sem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.sem" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.sem_distrib">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">sem_distrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.sem_distrib" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.shiftdim">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">shiftdim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'repeat'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.shiftdim" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.softmax_bias">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">softmax_bias</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slope</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.softmax_bias" title="Permalink to this definition">¶</a></dt>
<dd><p>Symmetric softmax with bias. Only works for binary. Works elementwise.
Cannot use too small or large bias (roughly &lt; 1e-3 or &gt; 1 - 1e-3)
:param p: between 0 and 1.
:param slope: arbitary real value. 1 gives identity mapping, 0 always 0.5.
:param bias: between 1e-3 and 1 - 1e-3. Giving p=bias returns 0.5.
:return: transformed probability.
:type p: torch.FloatTensor
:type slope: torch.FloatTensor
:type bias: torch.FloatTensor
:rtype: torch.FloatTensor</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.softmax_mask">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">softmax_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">BoolTensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.softmax_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Allows having -np.inf in w to mask out, or give explicit bool mask
:param w:
:param dim:
:param mask:
:return:</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.std_distrib">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">std_distrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.std_distrib" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.sumto1">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">sumto1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.sumto1" title="Permalink to this definition">¶</a></dt>
<dd><p>Make v sum to 1 across dim, i.e., make dim conditioned on the rest.
dim can be a tuple.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>v</strong> – tensor.</p></li>
<li><p><strong>dim</strong> – dimensions to be conditioned upon the rest.</p></li>
<li><p><strong>axis</strong> – if given, overrides dim.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>tensor of the same shape as v.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.t">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">t</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.t" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.tensor">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_ndim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.tensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a tensor if the input is not; otherwise return the input as is.
Same as enforce_tensor
:param v:
:param min_ndim:
:param kwargs:
:return:</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.test_kron">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">test_kron</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.test_kron" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.test_softmax_bias">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">test_softmax_bias</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.test_softmax_bias" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.unblock_diag">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">unblock_diag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size_block</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.unblock_diag" title="Permalink to this definition">¶</a></dt>
<dd><p>The inverse of block_diag(). Not vectorized yet.
:param m: block diagonal matrix
:param n: int. Number of blocks
:size_block: torch.Size. Size of a block.
:return: tensor unblocked such that the last sizes are [n] + size_block</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.unravel_index">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">unravel_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.unravel_index" title="Permalink to this definition">¶</a></dt>
<dd><p>For now, just use np.unravel_index()
:type v: torch.LongTensor
:type shape: torch.Size, tuple, list
:type kwargs: dict
:return: torch.LongTensor</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.v2m">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">v2m</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.v2m" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.v2m0">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">v2m0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.v2m0" title="Permalink to this definition">¶</a></dt>
<dd><p>Vector dim comes first, unlike v2m</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.var_distrib">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">var_distrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.var_distrib" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.vec2mat0">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">vec2mat0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.vec2mat0" title="Permalink to this definition">¶</a></dt>
<dd><p>Vector dim comes first, unlike v2m</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.vec2matmul">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">vec2matmul</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.vec2matmul" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.vec_on">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">vec_on</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndim</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.vec_on" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.vec_on_dim">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">vec_on_dim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndim</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.vec_on_dim" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.vmpdf">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">vmpdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.vmpdf" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.vmpdf_a_given_b">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">vmpdf_a_given_b</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a_prad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_prad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pconc</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.vmpdf_a_given_b" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a_prad</strong> (<em>torch.Tensor</em>) – between 0 and 1. Maps to 0 and 2*pi.</p></li>
<li><p><strong>b_prad</strong> (<em>torch.Tensor</em>) – between 0 and 1. Maps to 0 and 2*pi.</p></li>
<li><p><strong>pconc</strong> – float</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>p_a_given_b[index_a, index_b]</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meslas.external_dependencies.numpytorch.vmpdf_prad_pconc">
<span class="sig-prename descclassname"><span class="pre">meslas.external_dependencies.numpytorch.</span></span><span class="sig-name descname"><span class="pre">vmpdf_prad_pconc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ploc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pconc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meslas.external_dependencies.numpytorch.vmpdf_prad_pconc" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prad</strong> – 0 to 1 maps to 0 to 2*pi radians</p></li>
<li><p><strong>pconc</strong> – 0 to 1 maps to 0 to inf concentration</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-meslas.external_dependencies">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-meslas.external_dependencies" title="Permalink to this heading">¶</a></h2>
</section>
</section>


           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, Trygve Olav Fossum, Jo Eidsvik, David Ginsbourger, Cedric Travelletti.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>